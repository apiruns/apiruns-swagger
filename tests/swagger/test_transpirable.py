from apiruns_swagger.transpirables import json_to_yaml


def test_json_to_yaml(schema):
    expected = "info:\n  title: Swagger doc - OpenAPI 3.0\n  version: 1.0.11\nopenapi: 3.0.3\npaths:\n  /pepito:\n    delete:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    get:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    patch:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id001\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id001\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    post:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id002\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id002\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    put:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id003\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id003\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n  /rafa:\n    delete:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    get:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    patch:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id004\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id004\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    post:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id005\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id005\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n    put:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                name: &id006\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  name: *id006\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n          description: Successful operation\n  /users:\n    delete:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  age:\n                    type: integer\n                  is_admin:\n                    type: boolean\n                  level:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n                  username:\n                    type: string\n          description: Successful operation\n    get:\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  age:\n                    type: integer\n                  is_admin:\n                    type: boolean\n                  level:\n                    type: string\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n                  username:\n                    type: string\n          description: Successful operation\n    patch:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                age: &id007\n                  type: integer\n                is_admin: &id008\n                  type: boolean\n                level: &id009\n                  type: string\n                username: &id010\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  age: *id007\n                  is_admin: *id008\n                  level: *id009\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n                  username: *id010\n          description: Successful operation\n    post:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                age: &id011\n                  type: integer\n                is_admin: &id012\n                  type: boolean\n                level: &id013\n                  type: string\n                username: &id014\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  age: *id011\n                  is_admin: *id012\n                  level: *id013\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n                  username: *id014\n          description: Successful operation\n    put:\n      requestBody:\n        content:\n          application/json:\n            schema:\n              properties:\n                age: &id015\n                  type: integer\n                is_admin: &id016\n                  type: boolean\n                level: &id017\n                  type: string\n                username: &id018\n                  type: string\n              type: object\n      responses:\n        '200':\n          content:\n            application/json:\n              schema:\n                properties:\n                  age: *id015\n                  is_admin: *id016\n                  level: *id017\n                  public_id:\n                    example: 550e8400-e29b-41d4-a716-446655440000\n                    type: string\n                  username: *id018\n          description: Successful operation\nservers:\n- url: http://localhost:8080\n"
    specification = json_to_yaml(schema)
    assert expected == specification
